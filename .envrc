# direnv configuration for WhisperX cuDNN fix
# Install direnv and run: direnv allow

source_env_if_exists .env

# Activate existing uv venv (don't create a new one)
export VIRTUAL_ENV="$(pwd)/.venv"
PATH_add "$VIRTUAL_ENV/bin"

# CUDA 13.1 toolchain
export CUDA_HOME=/usr/local/cuda-13.1
PATH_add "$CUDA_HOME/bin"
export LD_LIBRARY_PATH="$CUDA_HOME/lib64:${LD_LIBRARY_PATH}"
export CUDACXX="$CUDA_HOME/bin/nvcc"

# Set LD_LIBRARY_PATH for cuDNN
CUDNN_PATH="$VIRTUAL_ENV/lib/python3.12/site-packages/nvidia/cudnn/lib"

if [ -d "$CUDNN_PATH" ]; then
    export LD_LIBRARY_PATH="${CUDNN_PATH}:${LD_LIBRARY_PATH}"
fi
